<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>th8 Ultimate AI Showcase: Tech, UX & Finance</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Prompt', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0F172A',
                            primary: '#06B6D4',   // Retail/Growth
                            secondary: '#8B5CF6', // Consolidator
                            medical: '#EF4444',   // Healthcare
                            factory: '#F59E0B',   // Manufacturing
                            success: '#10B981',
                            surface: '#F8FAFC',
                            code: '#1E1E1E'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F1F5F9; color: #1E293B; }
        
        /* Layout & Scrollbars */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #E2E8F0; }
        ::-webkit-scrollbar-thumb { background: #94A3B8; border-radius: 3px; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Navigation Buttons */
        .nav-item {
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
        }
        .nav-item:hover { background-color: rgba(255,255,255,0.05); }
        .nav-item.active {
            background-color: rgba(255,255,255,0.1);
            border-left-color: currentColor; 
        }

        /* Tab System */
        .tab-btn {
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            color: #64748B;
        }
        .tab-btn:hover { color: #334155; }
        .tab-btn.active {
            border-bottom-color: #0F172A;
            color: #0F172A;
            font-weight: 700;
        }

        /* Tech/Code Styling */
        .code-block {
            background-color: #1E1E1E;
            color: #D4D4D4;
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            overflow-x: auto;
            border: 1px solid #333;
        }
        .json-key { color: #9CDCFE; }
        .json-string { color: #CE9178; }
        .json-num { color: #B5CEA8; }
        .json-bool { color: #569CD6; }
        
        /* Animation */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden">

    <!-- SIDEBAR: Use Case Selector -->
    <aside class="w-full md:w-72 bg-brand-dark text-white flex flex-col shrink-0 z-20 shadow-2xl">
        <div class="p-6 border-b border-white/10">
            <div class="flex items-center gap-3 mb-1">
                <div class="w-10 h-10 bg-gradient-to-br from-brand-primary to-blue-600 rounded-xl flex items-center justify-center font-black text-xl shadow-lg">th8</div>
                <div>
                    <h1 class="font-bold text-lg leading-tight">AI Manager</h1>
                    <p class="text-xs text-slate-400">Ultimate Showcase</p>
                </div>
            </div>
        </div>

        <div class="flex-1 overflow-y-auto py-6 space-y-8">
            <!-- Group 1 -->
            <div>
                <div class="px-6 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Growth & Retail</div>
                <button onclick="selectUseCase('replenish')" id="nav-replenish" class="nav-item w-full text-left px-6 py-3 flex items-center gap-3 text-slate-300 hover:text-white transition-colors active text-brand-primary">
                    <i class="fas fa-boxes-stacked w-5 text-center"></i>
                    <div>
                        <div class="font-medium">Auto-Replenish</div>
                        <div class="text-[10px] opacity-60">Prevent Stockout</div>
                    </div>
                </button>
                <button onclick="selectUseCase('consolidate')" id="nav-consolidate" class="nav-item w-full text-left px-6 py-3 flex items-center gap-3 text-slate-300 hover:text-white transition-colors text-brand-secondary">
                    <i class="fas fa-coins w-5 text-center"></i>
                    <div>
                        <div class="font-medium">Spend Consolidator</div>
                        <div class="text-[10px] opacity-60">Volume Discount</div>
                    </div>
                </button>
            </div>

            <!-- Group 2 -->
            <div>
                <div class="px-6 text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Healthcare & Factory</div>
                <button onclick="selectUseCase('expiry')" id="nav-expiry" class="nav-item w-full text-left px-6 py-3 flex items-center gap-3 text-slate-300 hover:text-white transition-colors text-brand-medical">
                    <i class="fas fa-prescription-bottle-medical w-5 text-center"></i>
                    <div>
                        <div class="font-medium">Expiry Optimizer</div>
                        <div class="text-[10px] opacity-60">Reduce Write-off</div>
                    </div>
                </button>
                <button onclick="selectUseCase('sourcing')" id="nav-sourcing" class="nav-item w-full text-left px-6 py-3 flex items-center gap-3 text-slate-300 hover:text-white transition-colors text-brand-factory">
                    <i class="fas fa-industry w-5 text-center"></i>
                    <div>
                        <div class="font-medium">Smart Sourcing</div>
                        <div class="text-[10px] opacity-60">Commodity Arbitrage</div>
                    </div>
                </button>
            </div>
        </div>

        <div class="p-6 bg-black/20 text-xs text-slate-500 border-t border-white/5">
            <div class="flex justify-between mb-1">
                <span>System Status:</span>
                <span class="text-green-400"><i class="fas fa-circle text-[8px] mr-1"></i>Online</span>
            </div>
            <div>v2.5.0 (Beta)</div>
        </div>
    </aside>

    <!-- MAIN AREA -->
    <main class="flex-1 flex flex-col h-full overflow-hidden bg-slate-50 relative">
        
        <!-- Top Bar: Title & Tabs -->
        <header class="bg-white border-b border-slate-200 px-8 py-4 flex flex-col md:flex-row md:items-center justify-between gap-4 shrink-0 shadow-sm z-10">
            <div>
                <h2 class="text-2xl font-bold text-slate-800" id="header-title">Select a Use Case</h2>
                <p class="text-sm text-slate-500" id="header-desc">Choose a scenario from the sidebar to begin.</p>
            </div>
            
            <div class="flex gap-6 text-sm font-medium">
                <button onclick="switchTab('ux')" id="tab-ux" class="tab-btn active px-2 pb-2 flex items-center gap-2">
                    <div class="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-xs"><i class="fas fa-mobile-alt"></i></div>
                    Agent Experience
                </button>
                <button onclick="switchTab('tech')" id="tab-tech" class="tab-btn px-2 pb-2 flex items-center gap-2">
                    <div class="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-xs"><i class="fas fa-code"></i></div>
                    System Intelligence
                </button>
                <button onclick="switchTab('finance')" id="tab-finance" class="tab-btn px-2 pb-2 flex items-center gap-2">
                    <div class="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-xs"><i class="fas fa-chart-line"></i></div>
                    Business Impact
                </button>
            </div>
        </header>

        <!-- CONTENT CONTAINER -->
        <div class="flex-1 overflow-y-auto p-4 md:p-8 relative">
            
            <!-- TAB 1: UX/UI Interactive Flow -->
            <div id="view-ux" class="max-w-5xl mx-auto animate-slide-up h-full flex flex-col">
                <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden flex flex-col md:flex-row h-full max-h-[700px]">
                    <!-- Left: Context Panel -->
                    <div class="w-full md:w-1/3 bg-slate-50 border-r border-slate-200 p-6 flex flex-col">
                        <div class="mb-6">
                            <span class="px-2 py-1 rounded text-xs font-bold bg-white border border-slate-200 uppercase tracking-wide text-slate-500">Step 1: Trigger</span>
                            <h3 class="text-xl font-bold mt-2 text-slate-800">The Alert</h3>
                            <p class="text-sm text-slate-600 mt-2 leading-relaxed" id="ux-trigger-desc">...</p>
                        </div>
                        <div class="flex-1 flex items-center justify-center">
                            <div class="w-full bg-white p-4 rounded-xl border border-slate-200 shadow-sm relative">
                                <div class="absolute -top-2 -right-2 w-4 h-4 bg-red-500 rounded-full animate-ping"></div>
                                <div class="flex gap-3">
                                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-xl" id="ux-icon-box">üîî</div>
                                    <div>
                                        <div class="font-bold text-sm text-slate-800">New Notification</div>
                                        <div class="text-xs text-slate-500" id="ux-notif-text">...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 text-center">
                            <i class="fas fa-arrow-down text-slate-300 animate-bounce"></i>
                        </div>
                    </div>

                    <!-- Right: Interactive Card -->
                    <div class="w-full md:w-2/3 bg-white p-8 relative flex flex-col">
                        <span class="px-2 py-1 rounded text-xs font-bold bg-slate-100 border border-slate-200 uppercase tracking-wide text-slate-500 w-fit mb-4">Step 2 & 3: Proposal & Action</span>
                        
                        <!-- Dynamic AI Card -->
                        <div class="border border-slate-200 rounded-2xl shadow-lg overflow-hidden flex-1 flex flex-col">
                            <div class="p-4 text-white flex justify-between items-center" id="ux-card-header">
                                <div class="font-bold flex items-center gap-2">
                                    <i class="fas fa-robot"></i> AI Recommendation
                                </div>
                                <span class="text-xs bg-white/20 px-2 py-1 rounded">High Confidence</span>
                            </div>
                            
                            <div class="p-6 flex-1 flex flex-col">
                                <!-- Insight Section -->
                                <div class="mb-6">
                                    <h4 class="text-xs font-bold text-slate-400 uppercase mb-2">Insight Analysis</h4>
                                    <p class="text-slate-700 text-lg font-medium leading-relaxed" id="ux-insight-text">Loading...</p>
                                </div>

                                <!-- Chart Area -->
                                <div class="flex-1 bg-slate-50 rounded-xl p-4 mb-6 relative">
                                    <canvas id="mainChart"></canvas>
                                </div>

                                <!-- Action Button -->
                                <button onclick="simulateAction()" id="ux-action-btn" class="w-full py-4 rounded-xl font-bold text-white shadow-lg transform transition-all active:scale-95 flex items-center justify-center gap-3 text-lg">
                                    <span>Loading...</span>
                                </button>
                            </div>
                        </div>

                        <!-- Success Overlay -->
                        <div id="ux-success-overlay" class="absolute inset-0 bg-white/95 backdrop-blur z-10 flex flex-col items-center justify-center hidden">
                            <div class="w-20 h-20 bg-green-100 text-green-500 rounded-full flex items-center justify-center text-4xl mb-4 animate-bounce">
                                <i class="fas fa-check"></i>
                            </div>
                            <h3 class="text-2xl font-bold text-slate-800">Executed!</h3>
                            <p class="text-slate-500 mt-2" id="ux-success-msg">Action completed successfully.</p>
                            <button onclick="resetUX()" class="mt-8 text-slate-400 underline hover:text-slate-600">Replay</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 2: Tech Specs (Intelligence) -->
            <div id="view-tech" class="max-w-6xl mx-auto animate-slide-up hidden grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- Col 1: Context & Logic -->
                <div class="space-y-6">
                    <div class="bg-slate-900 text-slate-300 rounded-xl overflow-hidden shadow-lg border border-slate-700">
                        <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
                            <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-database text-blue-400"></i> Context Engineering</h3>
                            <span class="text-xs font-mono text-slate-500">JSON Input</span>
                        </div>
                        <div class="p-4">
                            <div class="code-block" id="tech-context">Loading...</div>
                        </div>
                    </div>

                    <div class="bg-slate-900 text-slate-300 rounded-xl overflow-hidden shadow-lg border border-slate-700">
                        <div class="bg-slate-800 px-4 py-3 border-b border-slate-700 flex justify-between items-center">
                            <h3 class="font-bold text-white flex items-center gap-2"><i class="fas fa-brain text-purple-400"></i> Logic & Reasoning</h3>
                            <span class="text-xs font-mono text-slate-500">Hybrid (Rule + LLM)</span>
                        </div>
                        <div class="p-4 space-y-4">
                            <div>
                                <div class="text-xs text-blue-400 font-bold mb-1">Hard Rule (Python):</div>
                                <div class="code-block" id="tech-rule">Loading...</div>
                            </div>
                            <div>
                                <div class="text-xs text-purple-400 font-bold mb-1">GenAI Prompt:</div>
                                <div class="code-block border-purple-900/50" id="tech-prompt">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Col 2: Audit & Monitoring -->
                <div class="space-y-6">
                    <div class="bg-white rounded-xl shadow-lg border border-slate-200 p-6">
                        <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="fas fa-list-ul text-slate-400"></i> Audit Trail</h3>
                        <p class="text-sm text-slate-500 mb-4">Immutable log entry generated upon action.</p>
                        <div class="code-block bg-slate-50 border-slate-200 text-slate-600" id="tech-audit">Loading...</div>
                    </div>

                    <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-xl shadow-lg border border-slate-700 p-6 text-white">
                        <h3 class="font-bold mb-4 flex items-center gap-2"><i class="fas fa-tower-broadcast text-green-400"></i> System Monitoring</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white/5 rounded p-3 text-center">
                                <div class="text-xs text-slate-400">Latency</div>
                                <div class="text-xl font-mono font-bold text-green-400">~200ms</div>
                            </div>
                            <div class="bg-white/5 rounded p-3 text-center">
                                <div class="text-xs text-slate-400">Accuracy</div>
                                <div class="text-xl font-mono font-bold text-blue-400">98.5%</div>
                            </div>
                            <div class="bg-white/5 rounded p-3 text-center col-span-2">
                                <div class="text-xs text-slate-400">Last Model Retrain</div>
                                <div class="text-sm font-mono">2024-01-05 02:00 UTC</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 3: Business Impact (Finance) -->
            <div id="view-finance" class="max-w-6xl mx-auto animate-slide-up hidden grid grid-cols-1 lg:grid-cols-2 gap-8">
                
                <!-- ROI Analysis -->
                <div class="bg-white rounded-2xl shadow-xl border border-slate-200 p-8 flex flex-col justify-center">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center text-emerald-600 text-2xl"><i class="fas fa-calculator"></i></div>
                        <div>
                            <h3 class="text-2xl font-bold text-slate-800">ROI Calculator</h3>
                            <p class="text-sm text-slate-500">Projected Annual Impact</p>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="flex justify-between items-center p-4 bg-red-50 rounded-xl border border-red-100">
                            <div>
                                <div class="text-xs font-bold text-red-400 uppercase">Cost of Inaction</div>
                                <div class="text-slate-600 text-sm" id="fin-cost-desc">...</div>
                            </div>
                            <div class="text-2xl font-bold text-red-600" id="fin-cost-val">...</div>
                        </div>

                        <div class="flex justify-center text-slate-300"><i class="fas fa-arrow-down"></i></div>

                        <div class="flex justify-between items-center p-6 bg-emerald-50 rounded-xl border border-emerald-100 shadow-sm">
                            <div>
                                <div class="text-xs font-bold text-emerald-500 uppercase">AI Value Add</div>
                                <div class="text-slate-600 text-sm" id="fin-gain-desc">...</div>
                            </div>
                            <div class="text-4xl font-bold text-emerald-600" id="fin-gain-val">...</div>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 border-t border-slate-100">
                        <div class="text-xs font-mono text-slate-400 mb-1">Calculation Logic:</div>
                        <div class="bg-slate-100 p-2 rounded text-xs font-mono text-slate-600" id="fin-formula">...</div>
                    </div>
                </div>

                <!-- P&L Statement -->
                <div class="bg-slate-900 text-white rounded-2xl shadow-xl border border-slate-700 p-8">
                    <div class="flex items-center gap-3 mb-8">
                        <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center text-blue-400 text-2xl"><i class="fas fa-file-invoice-dollar"></i></div>
                        <div>
                            <h3 class="text-2xl font-bold">P&L Impact</h3>
                            <p class="text-sm text-slate-400">Where it hits the statement</p>
                        </div>
                    </div>

                    <div class="space-y-4 font-mono">
                        <div class="flex justify-between items-center p-3 rounded hover:bg-white/5 transition-colors" id="row-rev">
                            <span class="text-slate-400">Revenue (Sales)</span>
                            <span class="font-bold">---</span>
                        </div>
                        <div class="flex justify-between items-center p-3 rounded hover:bg-white/5 transition-colors" id="row-cogs">
                            <span class="text-slate-400">Cost of Goods Sold (COGS)</span>
                            <span class="font-bold">---</span>
                        </div>
                        <div class="flex justify-between items-center p-3 border-t border-slate-700">
                            <span class="text-slate-200">Gross Profit</span>
                            <span class="font-bold text-slate-200">---</span>
                        </div>
                        <div class="flex justify-between items-center p-3 rounded hover:bg-white/5 transition-colors" id="row-sga">
                            <span class="text-slate-400">SG&A Expenses</span>
                            <span class="font-bold">---</span>
                        </div>
                        <div class="mt-4 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-xl flex justify-between items-center">
                            <span class="text-emerald-400 font-bold">Net Profit Impact</span>
                            <span class="text-xl font-bold text-emerald-400">POSITIVE ‚Üó</span>
                        </div>
                    </div>

                    <div class="mt-8 p-4 bg-white/5 rounded-lg text-xs text-slate-400 italic border border-white/10">
                        <i class="fas fa-quote-left mr-2"></i> <span id="fin-cfo-note">...</span>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Data & Logic -->
    <script>
        // --- Unified Data Source ---
        const useCases = {
            replenish: {
                id: 'replenish',
                title: 'Auto-Replenishment',
                desc: 'Prevent stockouts before they happen.',
                theme: 'bg-brand-primary',
                btnColor: 'bg-[#06B6D4] hover:bg-[#0891B2]',
                
                // 1. UX Data
                ux: {
                    trigger: '‡∏™‡∏≤‡∏Ç‡∏≤ "Siam Center" ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á Stockout ‡πÉ‡∏ô 48 ‡∏ä‡∏°. (Demand ‡∏û‡∏∏‡πà‡∏á‡∏™‡∏π‡∏á)',
                    notif: 'Stock Alert: High Risk',
                    insight: '‡πÄ‡∏ó‡∏®‡∏Å‡∏≤‡∏•‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤‡∏ô‡∏µ‡πâ‡πÇ‡∏ï <span class="text-[#06B6D4] font-bold">+35%</span> ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (5 ‡∏•‡∏±‡∏á) ‡∏à‡∏∞‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå',
                    actionBtn: 'Approve PO (70 Units)',
                    successMsg: 'PO #8821 sent to Aroma Thai. Delivery ETA: Tomorrow 10 AM.',
                    chartType: 'line',
                    chartData: {
                        labels: ['M','T','W','Th','F','S'],
                        datasets: [
                            {label:'Stock', data:[50,40,30,20,5,0], borderColor:'#EF4444', borderWidth:2},
                            {label:'Demand', data:[10,10,10,15,30,40], borderColor:'#06B6D4', borderDash:[5,5], borderWidth:2}
                        ]
                    }
                },

                // 2. Tech Data
                tech: {
                    context: `{"store_id": "Siam_Center", "sku": "Coffee_Bean", "stock": 5, "forecast_demand": 105, "event": "New Year"}`,
                    rule: `if stock < (daily_sales * lead_time) + safety_stock:\n    trigger_alert("HIGH_RISK")\n    create_po(qty=forecast - stock)`,
                    prompt: `Context: {JSON}\nTask: Explain reorder urgency.\nOutput: "Stock covers 1 day. New Year traffic expected to deplete inventory by Friday."`,
                    audit: `{"action": "AUTO_PO", "qty": 70, "reason": "STOCKOUT_PREVENTION", "user": "Mgr_01", "timestamp": "2024-01-05T09:41:00Z"}`
                },

                // 3. Finance Data
                finance: {
                    cost: '‡∏ø50,000 / Day',
                    costDesc: 'Lost Revenue from Stockout',
                    gain: '+‡∏ø1.5 Million',
                    gainDesc: 'Annual Revenue Saved (Est.)',
                    formula: 'Avg_Daily_Sales * Avoided_OOS_Days',
                    pnl: {
                        rev: { text: '‚¨Ü INCREASES', class: 'text-emerald-400' },
                        cogs: { text: '‚¨á Optimized', class: 'text-slate-400' },
                        sga: { text: '---', class: 'text-slate-400' }
                    },
                    cfoNote: 'Impact: ‡πÄ‡∏û‡∏¥‡πà‡∏° Top Line (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ) ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏µ‡∏¢‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏Ç‡∏≤‡∏¢‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á High Season'
                }
            },

            consolidate: {
                id: 'consolidate',
                title: 'Spend Consolidator',
                desc: 'Merge orders to unlock bulk discounts.',
                theme: 'bg-brand-secondary',
                btnColor: 'bg-[#8B5CF6] hover:bg-[#7C3AED]',

                ux: {
                    trigger: '‡∏û‡∏ö PR "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏© A4" ‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å 3 ‡πÅ‡∏ú‡∏ô‡∏Å (IT, HR, Mkt)',
                    notif: 'Savings Opportunity Found',
                    insight: '‡∏´‡∏≤‡∏Å‡∏£‡∏ß‡∏° 3 Orders ‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏¢‡∏≠‡∏î 500 ‡∏£‡∏µ‡∏° ‡∏ã‡∏∂‡πà‡∏á‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å <span class="text-[#8B5CF6] font-bold">Volume Discount 15%</span> ‡∏à‡∏≤‡∏Å Vendor A',
                    actionBtn: 'Consolidate & Issue PO',
                    successMsg: '3 PRs merged. New PO #9902 issued with 15% discount applied.',
                    chartType: 'bar',
                    chartData: {
                        labels: ['Separate', 'Consolidated'],
                        datasets: [{
                            label: 'Total Cost (THB)',
                            data: [45000, 38250],
                            backgroundColor: ['#94A3B8', '#8B5CF6']
                        }]
                    }
                },

                tech: {
                    context: `{"pending_prs": [{"dept":"IT", "item":"Paper", "qty":100}, {"dept":"HR", "item":"Paper", "qty":200}], "supplier_tier": {"500_units": "15%_off"}}`,
                    rule: `if sum(pr.qty) >= supplier.bulk_tier:\n    consolidate_prs()\n    apply_discount_code("BULK_15")`,
                    prompt: `Task: Normalize Item Names.\nInput: ["A4 Paper", "Copy Paper 80g"]\nOutput: "Office Paper A4 80gsm"`,
                    audit: `{"action": "MERGE_PR", "original_count": 3, "savings": 4500.00, "merged_po_id": "PO-9902"}`
                },

                finance: {
                    cost: '‡∏ø6,500 / Order',
                    costDesc: 'Overpaid due to Retail Pricing',
                    gain: '+‡∏ø54,000',
                    gainDesc: 'Annual Cost Savings (Est.)',
                    formula: '(Retail_Price - Bulk_Price) * Total_Volume',
                    pnl: {
                        rev: { text: '---', class: 'text-slate-400' },
                        cogs: { text: '---', class: 'text-slate-400' },
                        sga: { text: '‚¨á DECREASES', class: 'text-emerald-400' }
                    },
                    cfoNote: 'Impact: ‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô (SG&A) ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ Volume Discount'
                }
            },

            expiry: {
                id: 'expiry',
                title: 'Expiry Optimizer',
                desc: 'Move stock before it expires.',
                theme: 'bg-brand-medical',
                btnColor: 'bg-[#EF4444] hover:bg-[#DC2626]',

                ux: {
                    trigger: '‡∏¢‡∏≤ "Augmentin" ‡πÉ‡∏ô Ward 4 ‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏ô 60 ‡∏ß‡∏±‡∏ô (‡∏¢‡∏≠‡∏î‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≠‡∏¢)',
                    notif: 'Critical: Expiry Risk',
                    insight: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÉ‡∏ô Ward 4 ‡∏ï‡πà‡∏≥‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡∏ó‡∏µ‡πà <span class="text-[#EF4444] font-bold">OPD Pharmacy</span> ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏Ç‡∏≤‡∏î',
                    actionBtn: 'Transfer Stock (Ward->OPD)',
                    successMsg: 'Transfer Request #TR-102 Approved. Porters notified to move stock.',
                    chartType: 'bar',
                    chartData: {
                        labels: ['Ward 4 (Current)', 'OPD (Target)'],
                        datasets: [{
                            label: 'Daily Usage Rate',
                            data: [2, 50],
                            backgroundColor: ['#EF4444', '#10B981']
                        }]
                    }
                },

                tech: {
                    context: `{"batch": "B882", "expiry": "60_days", "loc_A_burn": 0.5, "loc_B_burn": 50.0}`,
                    rule: `if days_to_expiry < threshold AND usage_rate < stock:\n    find_location_with_high_demand()\n    transfer_stock(from=A, to=B)`,
                    prompt: `Analyze Risk:\nIf stock stays in Ward 4, write-off probability = 99%.\nAction: Move immediately.`,
                    audit: `{"action": "TRANSFER", "sku": "Augmentin", "avoided_loss": 25000.00, "from": "Ward_4", "to": "OPD"}`
                },

                finance: {
                    cost: '‡∏ø250,000 / Qtr',
                    costDesc: 'Inventory Write-off Value',
                    gain: '+‡∏ø1 Million',
                    gainDesc: 'Annual Write-off Avoided',
                    formula: 'Stock_Value * (100% - Recovery_Rate)',
                    pnl: {
                        rev: { text: '---', class: 'text-slate-400' },
                        cogs: { text: '‚¨á DECREASES', class: 'text-emerald-400' },
                        sga: { text: '---', class: 'text-slate-400' }
                    },
                    cfoNote: 'Impact: ‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏Ç‡∏≤‡∏¢ (COGS) ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏π‡∏ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (Inventory Write-off)'
                }
            },

            sourcing: {
                id: 'sourcing',
                title: 'Smart Sourcing',
                desc: 'Buy low, lock price.',
                theme: 'bg-brand-factory',
                btnColor: 'bg-[#F59E0B] hover:bg-[#D97706]',

                ux: {
                    trigger: '‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏°‡πá‡∏î‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å (Resin) ‡∏ï‡∏•‡∏≤‡∏î‡πÇ‡∏•‡∏Å‡∏£‡πà‡∏ß‡∏á‡πÅ‡∏ï‡∏∞ Target Price ‡πÅ‡∏•‡πâ‡∏ß',
                    notif: 'Market Opportunity',
                    insight: '‡∏£‡∏≤‡∏Ñ‡∏≤ Spot Price ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà $1,200/Ton ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡πÄ‡∏î‡∏¥‡∏° <span class="text-[#F59E0B] font-bold">10% ($150)</span>',
                    actionBtn: 'Lock Price & Issue PO',
                    successMsg: 'PO Locked at $1,200/Ton with Supplier B. Contract updated.',
                    chartType: 'line',
                    chartData: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Now'],
                        datasets: [{
                            label: 'Global Price ($)',
                            data: [1400, 1380, 1350, 1300, 1250, 1200],
                            borderColor: '#F59E0B', backgroundColor: 'rgba(245, 158, 11, 0.1)', fill: true
                        }]
                    }
                },

                tech: {
                    context: `{"commodity": "Resin", "contract_price": 1350, "spot_price": 1200, "vol": 100}`,
                    rule: `if spot_price < contract_price - switching_cost:\n    trigger_buy_signal()\n    lock_price(qty=100)`,
                    prompt: `Task: Draft Negotiation Email.\nContext: Market price is $1200.\nOutput: "Dear Supplier, based on LME index dropping..."`,
                    audit: `{"action": "LOCK_PRICE", "spot": 1200, "variance_gain": 15000.00, "commodity": "Resin"}`
                },

                finance: {
                    cost: '$150 / Ton',
                    costDesc: 'Price Variance Loss',
                    gain: '+‡∏ø500,000',
                    gainDesc: 'Savings per Order Lot',
                    formula: '(Contract_Price - Spot_Price) * Volume',
                    pnl: {
                        rev: { text: '---', class: 'text-slate-400' },
                        cogs: { text: '‚¨á DECREASES', class: 'text-emerald-400' },
                        sga: { text: '---', class: 'text-slate-400' }
                    },
                    cfoNote: 'Impact: ‡πÄ‡∏û‡∏¥‡πà‡∏° Gross Margin ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏î‡∏¥‡∏ö (Raw Material Cost)'
                }
            }
        };

        // --- State Management ---
        let currentUseCase = 'replenish';
        let currentTab = 'ux';
        let chartInstance = null;

        // --- Main Functions ---

        function init() {
            selectUseCase('replenish');
        }

        function selectUseCase(id) {
            currentUseCase = id;
            const data = useCases[id];

            // 1. Update Sidebar Active State
            document.querySelectorAll('.nav-item').forEach(el => {
                el.classList.remove('active', 'bg-white/10', 'border-l-brand-primary', 'border-l-brand-secondary', 'border-l-brand-medical', 'border-l-brand-factory');
                // Reset text colors to default slate-300
                el.classList.remove('text-white'); 
                el.classList.add('text-slate-300');
            });
            const activeBtn = document.getElementById(`nav-${id}`);
            activeBtn.classList.add('active', 'text-white');
            activeBtn.classList.remove('text-slate-300');

            // 2. Update Headers
            document.getElementById('header-title').innerText = data.title;
            document.getElementById('header-desc').innerText = data.desc;

            // 3. Render Content based on current tab (to refresh data)
            renderContent();
        }

        function switchTab(tabId) {
            currentTab = tabId;
            
            // UI Toggle
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`tab-${tabId}`).classList.add('active');

            // View Toggle
            document.getElementById('view-ux').classList.add('hidden');
            document.getElementById('view-tech').classList.add('hidden');
            document.getElementById('view-finance').classList.add('hidden');
            
            const targetView = document.getElementById(`view-${tabId}`);
            targetView.classList.remove('hidden');
            targetView.classList.remove('animate-slide-up'); // Reset animation
            void targetView.offsetWidth; // Trigger reflow
            targetView.classList.add('animate-slide-up');

            renderContent();
        }

        function renderContent() {
            const data = useCases[currentUseCase];

            // --- RENDER UX TAB ---
            if (currentTab === 'ux') {
                document.getElementById('ux-trigger-desc').innerText = data.ux.trigger;
                document.getElementById('ux-notif-text').innerText = data.ux.notif;
                document.getElementById('ux-card-header').className = `p-4 text-white flex justify-between items-center ${data.theme}`;
                document.getElementById('ux-insight-text').innerHTML = data.ux.insight;
                document.getElementById('ux-icon-box').className = `w-10 h-10 rounded-full flex items-center justify-center text-xl text-white ${data.theme}`;
                
                const btn = document.getElementById('ux-action-btn');
                btn.innerHTML = `<span>${data.ux.actionBtn}</span> <i class="fas fa-arrow-right"></i>`;
                btn.className = `w-full py-4 rounded-xl font-bold text-white shadow-lg transform transition-all active:scale-95 flex items-center justify-center gap-3 text-lg ${data.btnColor}`;
                btn.disabled = false;

                document.getElementById('ux-success-overlay').classList.add('hidden');
                document.getElementById('ux-success-msg').innerText = data.ux.successMsg;

                renderChart(data.ux.chartType, data.ux.chartData);
            }

            // --- RENDER TECH TAB ---
            if (currentTab === 'tech') {
                highlightCode('tech-context', data.tech.context);
                highlightCode('tech-rule', data.tech.rule);
                highlightCode('tech-prompt', data.tech.prompt);
                highlightCode('tech-audit', data.tech.audit);
            }

            // --- RENDER FINANCE TAB ---
            if (currentTab === 'finance') {
                document.getElementById('fin-cost-val').innerText = data.finance.cost;
                document.getElementById('fin-cost-desc').innerText = data.finance.costDesc;
                document.getElementById('fin-gain-val').innerText = data.finance.gain;
                document.getElementById('fin-gain-desc').innerText = data.finance.gainDesc;
                document.getElementById('fin-formula').innerText = data.finance.formula;
                document.getElementById('fin-cfo-note').innerText = data.finance.cfoNote;

                updatePnLRow('row-rev', data.finance.pnl.rev);
                updatePnLRow('row-cogs', data.finance.pnl.cogs);
                updatePnLRow('row-sga', data.finance.pnl.sga);
            }
        }

        // Helper: Chart JS
        function renderChart(type, data) {
            if (chartInstance) chartInstance.destroy();
            const ctx = document.getElementById('mainChart').getContext('2d');
            chartInstance = new Chart(ctx, {
                type: type,
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: true } },
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        // Helper: Code Highlight
        function highlightCode(elementId, text) {
            const el = document.getElementById(elementId);
            let formatted = text.replace(/"([^"]+)":/g, '<span class="json-key">"$1"</span>:')
                                .replace(/: "([^"]+)"/g, ': <span class="json-string">"$1"</span>')
                                .replace(/: (\d+\.?\d*)/g, ': <span class="json-num">$1</span>')
                                .replace(/\b(if|else|return|def)\b/g, '<span class="json-bool">$1</span>');
            el.innerHTML = formatted;
        }

        // Helper: PnL Update
        function updatePnLRow(id, data) {
            const el = document.getElementById(id);
            const valSpan = el.querySelector('span.font-bold');
            valSpan.innerText = data.text;
            valSpan.className = "font-bold " + data.class;
        }

        // Interaction Simulation
        function simulateAction() {
            const btn = document.getElementById('ux-action-btn');
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Processing AI Agent...';
            btn.disabled = true;
            setTimeout(() => {
                document.getElementById('ux-success-overlay').classList.remove('hidden');
                document.getElementById('ux-success-overlay').classList.add('flex');
            }, 1000);
        }

        function resetUX() {
            document.getElementById('ux-success-overlay').classList.add('hidden');
            document.getElementById('ux-success-overlay').classList.remove('flex');
            renderContent();
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            init();
        });

    </script>
</body>
</html>